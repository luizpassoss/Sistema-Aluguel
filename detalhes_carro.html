<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Honda Civic - Detalhes</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #eef2f3;
    }

    header {
      background: linear-gradient(to right, #05011b, #114d89);
      color: white;
      padding: 15px 0;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      border-bottom: 4px solid #23a9ce;
    }

    .floating-form {
      background-color: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      padding: 30px 25px;
      width: 300px;
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      align-self: flex-start;
      position: relative;
      top: 0;
      right: 0;
    }

    .floating-form h1 {
      margin: 0;
      font-size: 26px;
      text-align: center;
    }

    .floating-form h3.price {
      font-size: 26px;
      color: #0d47a1;
      text-align: center;
      margin: 0;
      font-weight: bold;
    }

    .floating-form form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .floating-form label {
      font-weight: 500;
      font-size: 14px;
      color: #333;
    }

    .floating-form input,
    .floating-form textarea {
      padding: 10px 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      outline: none;
      transition: border 0.3s ease;
    }

    .floating-form input:focus,
    .floating-form textarea:focus {
      border-color: #0d47a1;
    }

    .floating-form button {
      background-color: #0d47a1;
      color: white;
      border: none;
      padding: 12px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .floating-form button:hover {
      background-color: #1565c0;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 10px 20px;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      color: #ffffff;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo span {
      font-weight: 700;
      font-size: 22px;
    }

    nav ul {
      list-style: none;
      display: flex;
      gap: 25px;
      margin: 0;
      padding: 0;
    }

    nav ul li a {
      color: #fff;
      text-decoration: none;
      font-size: 16px;
      font-weight: 500;
      position: relative;
    }

    nav ul li a:hover {
      color: #ffeb3b;
    }

    main {
      padding-top: 120px;
      display: flex;
      justify-content: center;
      padding-bottom: 50px;
    }

    .details-container {
      background: white;
      width: 90%;
      max-width: 1000px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      padding: 30px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .car-title {
      text-align: center;
      font-size: 28px;
      color: #00084d;
    }

    .footer {
      background: linear-gradient(to right, #05011b, #114d89);
      color: white;
      padding: 40px 20px;
      text-align: center;
      margin-top: 60px;
    }

    .footer-content {
      max-width: 1000px;
      margin: 0 auto;
    }

    .footer-links {
      list-style: none;
      padding: 0;
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    .footer-links li a {
      color: #ffffff;
      text-decoration: none;
      font-size: 15px;
      transition: color 0.3s;
    }

    .footer-links li a:hover {
      color: #ffeb3b;
    }

    .footer-copy {
      font-size: 13px;
      color: #cccccc;
      margin-top: 10px;
    }

    .footer-contact {
      margin-top: 10px;
      font-size: 15px;
    }

    .footer-contact a {
      color: #ffffff;
      text-decoration: underline;
      transition: color 0.3s;
    }

    .footer-contact a:hover {
      color: #25d366;
    }

    .footer-social {
      margin-top: 15px;
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .footer-social img {
      width: 24px;
      height: 24px;
      filter: invert(100%);
      transition: transform 0.3s ease;
    }

    .footer-social a:hover img {
      transform: scale(1.2);
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo">üöó <span>AlugaF√°cil</span></div>
      <nav>
        <ul>
          <li><a href="dashboard.html">Dashboard</a></li>
          <li><a href="clientes.html">Clientes</a></li>
          <li><a href="veiculos.html">Ve√≠culos</a></li>
          <li><a href="reservas.html">Reservas</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="details-container">
      <h2 class="car-title" id="carName">Honda Civic 2024</h2>
      <div style="display: flex; justify-content: space-between; padding: 30px; gap: 40px; flex-wrap: wrap;">
        <div style="flex: 2; min-width: 300px;">
          <h2 style="color: #222; font-size: 32px;" id="carTitleMarca">HONDA <span style="color:#0d47a1;">CIVIC</span></h2>
          <br />
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 16px;" id="carDetails"></div>
        </div>

        <div class="floating-form">
          <h1>Alugue Agora</h1>
          <h3 class="price" id="priceDisplay">R$ 120/dia</h3>
          <form id="reservationForm">
            <label for="clientId">ID do Cliente</label>
<input type="number" id="clientId" name="clientId" required />

            <label for="startDate">Data de In√≠cio</label>
            <input type="date" id="startDate" name="startDate" required />

            <label for="endDate">Data de T√©rmino</label>
            <input type="date" id="endDate" name="endDate" required />


            <button type="submit">Confirmar Aluguel</button>
          </form>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="footer-content">
      <p>Conectando voc√™ ao carro ideal com conforto e seguran√ßa.</p>
      <ul class="footer-links">
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="clientes.html">Clientes</a></li>
        <li><a href="veiculos.html">Ve√≠culos</a></li>
        <li><a href="reservas.html">Reservas</a></li>
      </ul>
      <div class="footer-contact">
        <p>üìû <strong>Fale Conosco:</strong> <a href="https://wa.me/5547991744754" target="_blank">(47) 99174-4754</a></p>
      </div>
      <div class="footer-social">
        <a href="https://wa.me/5547991744754" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp" /></a>
        <a href="https://instagram.com" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="Instagram" /></a>
        <a href="https://facebook.com" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook" /></a>
      </div>
      <p class="footer-copy">¬© 2025 AlugaF√°cil. Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const params = new URLSearchParams(window.location.search);
      const carId = params.get("id");
      if (!carId) {
        alert("Carro n√£o especificado.");
        return;
      }

      async function loadCarDetails() {
        try {
          const response = await fetch(`http://localhost:3000/api/carros/${carId}`);
          if (!response.ok) throw new Error("Erro ao buscar dados do carro");
          const car = await response.json();
          document.getElementById('carName').innerText = `${car.marca} ${car.modelo} ${car.ano}`;
          document.getElementById('carTitleMarca').innerHTML = `${car.marca.toUpperCase()} <span style="color:#0d47a1;">${car.modelo.toUpperCase()}</span>`;
          document.getElementById('priceDisplay').innerText = `R$ ${car.preco_diario}/dia`;
          document.getElementById('carDetails').innerHTML = `
            <div><strong>Marca:</strong> ${car.marca}</div>
            <div><strong>Modelo:</strong> ${car.modelo}</div>
            <div><strong>Ano:</strong> ${car.ano}</div>
            <div><strong>Pre√ßo por dia:</strong> R$ ${car.preco_diario}</div>
          `;
        } catch (error) {
          console.error("Erro ao carregar detalhes:", error);
          alert("N√£o foi poss√≠vel carregar os detalhes do carro.");
        }
      }

     document.getElementById('reservationForm').addEventListener('submit', async (event) => {
  event.preventDefault();
  const clientId = document.getElementById('clientId').value;
  const startDate = document.getElementById('startDate').value;
  const endDate = document.getElementById('endDate').value;

  if (!clientId || !startDate || !endDate) {
    return alert('Preencha todos os campos obrigat√≥rios!');
  }

  if (new Date(startDate) > new Date(endDate)) {
    return alert('A data de in√≠cio n√£o pode ser ap√≥s a data de t√©rmino.');
  }

  try {
    const response = await fetch('http://localhost:3000/api/alugueis', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        id_carro: Number(carId),
        id_cliente: Number(clientId),
        data_inicio: startDate,
        data_fim: endDate
      })
    });

    if (response.ok) {
      const result = await response.json();
      alert(`Aluguel realizado com sucesso! C√≥digo: ${result.id_aluguel}`);
      document.getElementById('reservationForm').reset();
    } else {
      const err = await response.json();
      alert(`Erro: ${err.message || 'Falha ao realizar o aluguel.'}`);
    }
  } catch (err) {
    console.error("Erro ao enviar aluguel:", err);
    alert('Erro ao enviar o aluguel.');
  }
});


      loadCarDetails();
    });
  </script>
</body>
</html>
